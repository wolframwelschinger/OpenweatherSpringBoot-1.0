"use strict";

/* Fragt ueber den Service WetterService die Wetterdaten aus der DB ab 
 * 
 */
wetterApp.controller('OrtListCtrl', function($scope, $log, $resource, $cookies, $locale, OrtService, OrtQuery) {

  $scope.isAdmin = false;

  $scope.orte = undefined;
  $scope.query = OrtQuery;    		// <-- Query-Instanz (Filtern und Paging)
  $scope.query.clearFilter();
  $scope.query.load('ort');  		// <-- Ausloesen der Query  
  
  console.log('+++ Locale: ' + $locale.id);

  /**
   * Callback-Handler fuer das erfolgreiche Laden des REST-Response
   */
  OrtQuery.onLoadSuccess = function(results) {
      $log.debug(results);
      $log.debug('>>> Anzahl der gefetchten Datensaetze: ' + results.length)
      $scope.orte = results;  // <-- Fetching des REST-Response 
  }
  
  /**
   * Callback-Handler fuer Fehler beim Laden des REST-Response
   */
  OrtQuery.onLoadFailure = function(err) {
      $log.debug('err' + err);
      //Flash.create('error', err);
  }

  /**
   * Callback vor dem AusfÃ¼hren des REST-Requests
   */
  OrtQuery.onLoad = function() {
      $log.debug('onLoad');
  } 
  
  /*
  // alle Orte in DE suchen
  var paramsDE = { 
      'filter' : { 'land' : 'DE' },
      'sort' : { 'orderBy' : 'ort', 'reverse' : false }
  }; 
  
  // alle Orte (kein Filter), sortiert nach Ort, Page 1
  var params = { 
	      'filter' : {},
	      'sort'   : { 'orderBy' : 'ort', 'reverse' : false },
	      'page'   : { 'index' : 0}
	  };  
  
  // Laden der Ort-Entries per REST-Call aus der DB 
  OrtService['get'](params).$promise
  .then(function(data){
	  console.log('Daten wurden geladen');
	  console.log(data);
	  console.log('Anzahl der Datensaetze: ' + data.totalElements)
	  $scope.orte = data.content;
  });
  */
  
});
