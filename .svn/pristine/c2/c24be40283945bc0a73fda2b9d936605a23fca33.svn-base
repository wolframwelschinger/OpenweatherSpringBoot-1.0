"use strict";

/*
 * Fragt ueber den Service WetterService die Wetterdaten aus der DB ab
 * 
 */
wetterApp.controller('OrtDetailCtrl', function($scope, $resource, $cookies, $locale, $location, OrtService) {

  $scope.isAdmin = true;
  $scope.isNew = true;
  var isDeleting = false;
  var isSaving = false;
  var isEditing = true;
  
  // Neuanlage oder vohandener Datensatz
  $scope.isNew = function() {
	  	return true;
		//return model.filter.id == "insert";
	}
	
	// Gibt an, ob die Maske im bearbeitungsmodus ist
  $scope.isEditing = function() {
	  	return false;
		//return isEditing || $scope.isNew();
	};  
  
  /* Datensatz speichern */	
  $scope.onSave = function(data){
	  console.log('onSave: '); /* + data.id);*/
	  
	  isSaving = true;
	  isEditing = false;	  
	  
	  // do save
	  OrtService['save'](null, data).$promise
		.then(function(data) {
			console.log('saving succeeded: ' + angular.toJson(data));
			isSaving = false;
			
			/*
			// Laden der Werte aus der Datenbank
			model.filter.id = data.id;
			$log.debug('loading ' + model.filter.id);
			$scope.load();
			*/
		})
		.catch(function(err) {
			console.log('saving failed: ' + angular.toJson(err.data || err));
			isSaving = false;
	
			/*
			// Laden der Werte aus der Datenbank
			$scope.load();
			*/
		});	  
  }
  
  /* Datensatz loeschen */
  $scope.onDelete = function(data){
	console.log('onDelete: ');
	
    // do delete
    OrtService['delete'](data).$promise
    .then(function(data) {
        $log.info('deleting succeeded: ' + angular.toJson(data));
        isDeleting = false;
    
        // Zur√ºck zur Liste
        $location.path('anwendung');
    })
    .catch(function(err) {
        $log.error('deleting failed: ' + angular.toJson(err.data || err));
        isDeleting = false;
    });	
  }

  /* Zurueck zur Uebersicht */
  $scope.onBack = function(){
	  console.log('cancel: Ort');
	  $location.path('orte');
  }
  
});
